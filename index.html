<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>ePubeee</title>

    <link type="text/css" rel="stylesheet" href="css/bootstrap.min.css" />
    <link type="text/css" rel="stylesheet" href="css/ePubeee.css" />

    <script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>

    <script type="text/javascript" src="js/base64.js"></script>
    <script type="text/javascript" src="js/sjis.js"></script>
    <script type="text/javascript" src="js/utf8.js"></script>
    <script type="text/javascript" src="js/jsinflate.js"></script>
    <script type="text/javascript" src="js/zip.js"></script>

    <script type="text/javascript" src="js/ePubeee.js" charset="utf-8"></script>

    <script type="text/javascript">
    function setHTML(id) {
    	var frameNode = document.getElementById("epub");
    	frameNode.contentWindow.document.body.innerHTML = epub.getHTML(id);
    };

    $(document).ready(function() {
      //EPUBファイル指定処理
      $("#epubFile").change(function() {
  	    //ファイルを変更された場合
  	    var fileData = document.getElementById("epubFile").files[0];
  	    epub.getLocal(fileData,success,error);
      });

      $("webBtn").click(function() {
    	  epub.getWeb($("#url").text(),success,error);
      });
      
      function success() {
  		for ( var idx = 0; idx < epub.pageList.length; ++idx ) {
  			
			var id = epub.pageList[idx];
			
			var li = $("<li/>");
			li.attr("id",id);
			if ( idx == 0 ) {
				li.addClass("active");
				setHTML(id);
			}

			var a = $("<a/>");
			a.attr("href","#" + id);
			a.attr("data-toggle","tab");
			a.attr("onclick","setHTML('" + id + "')");
			a.text(id);

			li.append(a);

			$("#nav").append(li);
		}
      };
      
      function error() {
    	alert("error!");
      }
    });
    </script>

  </head>

  <body>

    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="./index.html">ePubeee</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li class="active"><a href="#select" data-toggle="modal">Select...</a></li>
              <li><a href="#information" data-toggle="modal">Information</a></li>
              <li><a href="#index" data-toggle="modal">Index</a></li>
            </ul>

            <ul class="nav pull-right">
              <li><a href="https://github.com/secondarykey/ePubeee" target="_blank">GitHub</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="span12 tabbable tabs-left">
      <ul class="nav nav-tabs" id="nav">
	  </ul> 
      <div class="tab-content" id="tab-content">
	    <div class="tab-pane active" id="bookPanel" width="90%">
		  <iframe id="epub" width="90%" height="100%" src="empty.html"></iframe>
	    </div>
       </div>
    </div>

    <!-- Select File --> 
    <div id="select" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="selectLabel">Select EPUB File</h3>
      </div>
      <div class="modal-body">
            1.local = <input type="file" id="epubFile"/>
            <br>
            2.Web = <input type="text" id="url"/> <button class="btn" id="webBtn">GET</button>
      </div>
      <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
      </div>
    </div>

    <!-- Information --> 
    <div id="information" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="informationLabel">Information</h3>
      </div>
      <div class="modal-body">

      </div>
      <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
      </div>
    </div>
    

    <!-- Index --> 
    <div id="index" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="indexLabel">Index</h3>
      </div>
      <div class="modal-body">
 
      </div>
      <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
      </div>
    </div>

  </body>
</html>
